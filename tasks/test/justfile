set fallback := true
set shell := ["bash", "-uc"]

[no-cd]
all:
  @echo "Running mobile tests..."
  @src/tests/run-mobile.sh termux

[no-cd]
mobile platform="termux":
  @echo "Testing mobile bootstrap on {{platform}}..."
  @src/tests/run-mobile.sh {{platform}}

[no-cd]
clean:
  @echo "Cleaning up mobile test containers and volumes..."
  @docker compose -f src/tests/docker-compose.mobile.yml -p k-mobile-test down -v 2>/dev/null || true
  @docker ps -a --filter "name=k-test-*" -q | xargs -r docker rm -f 2>/dev/null || true
  @docker images -q "k-test-*" | xargs -r docker rmi -f 2>/dev/null || true
